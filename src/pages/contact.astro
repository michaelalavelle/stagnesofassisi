---
import BaseLayout from "../layouts/BaseLayout.astro";
---

<BaseLayout title="Contact | St. Agnes of Assisi Fraternity">
  <section class="hero">
    <h1>Contact</h1>
    <p>
      We would love to hear from you. Please reach out to learn more or to
      arrange a visit.
    </p>
  </section>

  <section class="card" style="margin-top: 2rem;">
    <h2 class="section-title">Get in Touch</h2>
    <p>
      Email us at
      <a href="mailto:ofs@example.org">ofs@example.org</a> (placeholder).
    </p>
    <p>
      You may also contact the Our Lady of Lourdes Parish office for assistance.
    </p>

    <form
      class="contact-form"
      action="https://formspree.io/f/mgoladbv"
      method="POST"
      data-formspree
    >
      <label>
        Your Name
        <input type="text" name="name" autocomplete="name" required />
      </label>
      <label>
        Email Address
        <input type="email" name="email" autocomplete="email" required />
      </label>
      <label>
        Phone (optional)
        <input type="tel" name="phone" autocomplete="tel" />
      </label>
      <label>
        Message
        <textarea name="message" rows="6" required></textarea>
      </label>
      <button type="submit" class="button">Send Message</button>
    </form>

    <div class="form-success" hidden>
      <h3>Thank You</h3>
      <p>
        Thank you for reaching out. Someone from our fraternity will get back to
        you shortly.
      </p>
    </div>
  </section>

  <script>
    const form = document.querySelector("[data-formspree]");
    const success = document.querySelector(".form-success");
    if (form instanceof HTMLFormElement && success instanceof HTMLElement) {
      const submitButton = form.querySelector('button[type="submit"]');
      form.addEventListener("submit", async (event) => {
        event.preventDefault();
        const data = new FormData(form);
        if (submitButton instanceof HTMLButtonElement) {
          submitButton.disabled = true;
          submitButton.textContent = "Sending...";
        }

        const response = await fetch(form.action, {
          method: form.method,
          body: data,
          headers: {
            Accept: "application/json",
          },
        });
        if (response.ok) {
          form.reset();
          form.hidden = true;
          success.hidden = false;
        } else {
          alert("Sorry, there was a problem sending your message.");
        }

        if (submitButton instanceof HTMLButtonElement) {
          submitButton.disabled = false;
          submitButton.textContent = "Send Message";
        }
      });
    }
  </script>
</BaseLayout>
